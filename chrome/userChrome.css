/* 
quick reference:
#navigator-toolbox is the root container of most firefox elements
-- #nav-bar contains nav buttons (back.. refresh), urlbar, extensions
#browser is the other primary container, nav toolbox's sibling, contains sidebar

fennec's target structure:

[ header ] - #nav-bar subset: nav buttons, extensions, settings
[ urlbar ] - #nav-bar.urlbar is moved out of header and put below
[ sideberry ] - firefox extension

this css code tends to be ordered with respect to dom top-bottom, left-right 
*/

:root {
  /* re-export the browser toolbar textcolor under a name the sidebar can use */
  --sidebar-from-toolbar: var(--toolbar-textcolor, #222);
}

/* ---------------------------------------- */

/* WORK IN PROGRES sidebar toggle:
   sideberry/history toggles the whole ui 
   if/when this is integrated, userchrome toggle is not needed */

/* the below css works if applied to browser toolbox after load,
   but trying to load this eagerly user userChrome.css
   interferes with Firefox's chrome loading pipeline 
   because we are hiding the element early, interfering
   with firefox's javascript loading the UI it seems*/

/* body:has(#sidebar-box[hidden="true"]) #navigator-toolbox {
  display: none !important;
} */

/* ---------------------------------------- */

/* style 1 - hide when all UI */
:root[titlepreface*="᠎"] {
  #navigator-toolbox {
    display: none !important;
  }
}

/* root node of everything mozilla */
#navigator-toolbox {
  position: absolute !important;
  z-index: 2 !important;  /* 3 spills extensions on page*/
  border: none !important;
  margin-top: 4px;
  margin-left: 2px;
}

/* the thing that comes up when you hold alt, there's already settings menu */
#toolbar-menubar {
  display: none;
}

/* Firefox's native tabs - always disable, depend on sideberry for tabs */
#TabsToolbar {
  display: none;
}

#tabbrowser-tabs {
  display: none !important;
}

#alltabs-button {
  display: none !important;
}

/* ---- s:header ---- */

/*  #nav-bar is basically fennec's header section, stubbed for structural reference */

/* #nav-bar {} */

/* #nav-bar-customization-target {
  background-color: var(--toolbar-textcolor);
} */

/* 
   #nav-bar.children (below) 
   note: we free nav-bar.urlbar with position absolute
*/

/* sidebar toggle - hide this */
#sidebar-button {
  display: none;
}

#back-button {
  margin-left: 37px !important;
}

/* #forward-button {
  display: none;
}  */

/* #stop-reload-button {
} */

/* home button - hide this */
#home-button {
  display: none;
}

/* START: spring1 (deprecated)

  #customizableui-special-spring1 and 2 are spacers 
  nav buttons - spring1 - url bar - spring2 - extensions/settings
*/

#customizableui-special-spring1 {
  display: none;
}

/* END: spring1 (deprecated) */


/* urlbar is here, we modify it later, just reference */
/* #urlbar-container{} */


/* START: spring2 (deprecated) */

#customizableui-special-spring2 {
  display: none;
} 

#vertical-spacer {
  display: none !important;
}

/* minimize, maximize, close buttons... can be disabled, I use hotkeys */
#navigator-toolbox .titlebar-buttonbox-container {
  display: none !important;
}

/* END: spring2 (deprecated) */

/* #downloads-button {
} */

/* #unified-extensions-button {
} */

/* all pinnned extensions overflow here... */

/* settings menu */ 
#PanelUI-button {
  position: absolute !important;
}

/* bookmarks area - always disable */
#PersonalToolbar {
  display: none;
}

/* ---- e:header ---- */



/* ---- s:urlbar ---- */

/* Pin Search Bar / Url bar above the sideberry tabs, and below the zen-sidebar top buttons */
#urlbar-container {
  position: absolute;
  top: 38px;
  width: 215px !important;
  max-width: 587px !important;
}

/* eager width adjustments for urlbar as sidebar width changes */
/* math - aesthetically urlbar width of 215 maps to a sidebar width of 224px */
/* 224 appears to be min-width default for sidebar */

/* 200s */
body:has(#browser > #sidebar-main[width^="22"]) #urlbar-container { width: 210px !important; }
body:has(#browser > #sidebar-main[width^="23"]) #urlbar-container { width: 217px !important; }
body:has(#browser > #sidebar-main[width^="23"]) #urlbar-container { width: 217px !important; }
body:has(#browser > #sidebar-main[width^="24"]) #urlbar-container { width: 227px !important; }
body:has(#browser > #sidebar-main[width^="25"]) #urlbar-container { width: 237px !important; }
body:has(#browser > #sidebar-main[width^="26"]) #urlbar-container { width: 247px !important; }
body:has(#browser > #sidebar-main[width^="27"]) #urlbar-container { width: 257px !important; }
body:has(#browser > #sidebar-main[width^="28"]) #urlbar-container { width: 267px !important; }
body:has(#browser > #sidebar-main[width^="29"]) #urlbar-container { width: 277px !important; }

/* 300s */
body:has(#browser > #sidebar-main[width^="30"]) #urlbar-container { width: 287px !important; }
body:has(#browser > #sidebar-main[width^="31"]) #urlbar-container { width: 297px !important; }
body:has(#browser > #sidebar-main[width^="32"]) #urlbar-container { width: 307px !important; }
body:has(#browser > #sidebar-main[width^="33"]) #urlbar-container { width: 317px !important; }
body:has(#browser > #sidebar-main[width^="34"]) #urlbar-container { width: 327px !important; }
body:has(#browser > #sidebar-main[width^="35"]) #urlbar-container { width: 337px !important; }
body:has(#browser > #sidebar-main[width^="36"]) #urlbar-container { width: 347px !important; }
body:has(#browser > #sidebar-main[width^="37"]) #urlbar-container { width: 357px !important; }
body:has(#browser > #sidebar-main[width^="38"]) #urlbar-container { width: 367px !important; }
body:has(#browser > #sidebar-main[width^="39"]) #urlbar-container { width: 377px !important; }

/* 400+ */
body:has(#browser > #sidebar-main[width^="4"]) #urlbar-container { width: 387px !important; }
body:has(#browser > #sidebar-main[width^="5"]) #urlbar-container { width: 487px !important; }
body:has(#browser > #sidebar-main[width^="6"]) #urlbar-container { width: 587px !important; }


/* remove google icon crowding search bar */
#urlbar-searchmode-switcher {
  display: none;
}

/* TODO after removing search move switcher, urlbar when */
/* .urlbar-input-container {
  padding-left: 5px !important;
} */

/* shield icon for tracking protections, don't need */
/* TODO make this shown on hover, rather than always hide */
.urlbar-input-container #tracking-protection-icon-container {
  display: none;
}

/* this will show "Not secure" if the connection is not secure, 
   there is already an icon, only selectively hide if safe  */
/* #identity-icon-label {} */

/* shows "Sideberry" if on its extension page, not strictly needed */
#identity-box.extensionPage #identity-icon-label {
  display: none;
}

/* shows Firefox if on settings, not strictly needed */
#identity-box.chromeUI #identity-icon-label {
  display: none;
}

/*
FIREFOX SECURITY STATES REFERENCE

Reasonably safe to customize:
- .chromeUI          - Firefox internal pages
- .extensionPage     - Extension pages  
- .verifiedDomain    - HTTPS with valid cert
- .verifiedIdentity  - EV certificates

Preserve these (security warnings):
- .notSecure         - HTTP or broken HTTPS
- .insecureLoginForms - HTTPS page with HTTP login
- .mixedContentBlocked - HTTPS with blocked mixed content
- .mixedActiveContent  - HTTPS with active mixed content
*/

/* hide the packlock if not hovered and only if site is secure */
/* `.mixedContentBlocked` could be worth surfacing, for warnings */
/* but it seems like .notSecure is always concerning, so we will surface that */
/* #identity-box:not(.notSecure) {
  opacity: 1;
  transform: translateX(0);
  transition: opacity 0.3s ease, transform 0.3s ease;
}
#urlbar:not(:hover) #identity-box:not(.notSecure) {
  opacity: 0;
  transform: translateX(-20px); 
  pointer-events: none;
  width: 0px;
} */

/* show a warning if the site is not secure when sidebar is open */
/* z-index 2 is above #nav-bar, ensure we are above it */
body:has(#identity-box.notSecure)::before {
  content: "🦊 Fennec CSS Alerts: 🔓 Not Secure";
  text-align: center;
  font-size: 24px;
  margin-left:15%;
  padding-top: 8px;
  display: block;
  position: absolute;
  z-index: 3;
  width: 85%;
  height: 46px;
  box-sizing: border-box;
  background-color: var(--toolbar-textcolor);
}

/* when sidebar is hidden show warning on not secure sites */
/* style 1 - hide when all UI */
:root[titlepreface*="᠎"] {
  body:has(#identity-box.notSecure)::before {
    content: "🦊 Fennec CSS Alerts: 🔓 Not Secure";
    text-align: center;
    font-size: 24px;
    margin-left: 0px;
    display: block;
    position: inherit;
    z-index: 3;
    width: 100%;
    height: 46px;
    padding-top: 8px;
    box-sizing: border-box;
    background-color: var(--toolbar-textcolor);
  }
}

/* on right-side of urlbar, favorite button, some other things I don't care */
#page-action-buttons {
  display: none !important;
}


/* ---- e:urlbar ---- */



/* ---- s:sidebar ---- */

#sidebar-tools-and-extensions-splitter {
  display: none !important;
}

#sidebar-launcher-splitter {
  width: 4px !important;
}


/* smallest width seems to be 224px */
/* style 1 - hide when all UI */
:root[titlepreface*="᠎"] {
  #sidebar-main {
    display: none !important;
  }
}

@media (hover: hover) {
  .tools-and-extensions {
    opacity: 0 !important;
    transform: translateX(6px) !important;
    /* NOTE: pointer-events is not set to none here so element can be hovered */
    transition: opacity .18s ease, transform .18s ease;
  }

  .tools-and-extensions:hover,
  .tools-and-extensions:focus-within {
    opacity: 1 !important;
    transform: translateX(0) !important;
  }
}

#sidebar-box > .sidebar-browser-stack:has(> browser[src*="webext-panels.xhtml"]) {
  margin-left: 6px !important;
}

/* 200s (two-digit prefixes) */
body:has(#browser > #sidebar-main[width^="22"]) #sidebar-box { width: 214px !important; max-width: 214px !important; }
body:has(#browser > #sidebar-main[width^="23"]) #sidebar-box { width: 221px !important; max-width: 221px !important; }
body:has(#browser > #sidebar-main[width^="24"]) #sidebar-box { width: 231px !important; max-width: 231px !important; }
body:has(#browser > #sidebar-main[width^="25"]) #sidebar-box { width: 241px !important; max-width: 241px !important; }
body:has(#browser > #sidebar-main[width^="26"]) #sidebar-box { width: 251px !important; max-width: 251px !important; }
body:has(#browser > #sidebar-main[width^="27"]) #sidebar-box { width: 261px !important; max-width: 261px !important; }
body:has(#browser > #sidebar-main[width^="28"]) #sidebar-box { width: 271px !important; max-width: 271px !important; }
body:has(#browser > #sidebar-main[width^="29"]) #sidebar-box { width: 281px !important; max-width: 281px !important; }

/* 300s (two-digit prefixes) */
body:has(#browser > #sidebar-main[width^="30"]) #sidebar-box { width: 291px !important; max-width: 291px !important; }
body:has(#browser > #sidebar-main[width^="31"]) #sidebar-box { width: 301px !important; max-width: 301px !important; }
body:has(#browser > #sidebar-main[width^="32"]) #sidebar-box { width: 311px !important; max-width: 311px !important; }
body:has(#browser > #sidebar-main[width^="33"]) #sidebar-box { width: 321px !important; max-width: 321px !important; }
body:has(#browser > #sidebar-main[width^="34"]) #sidebar-box { width: 331px !important; max-width: 331px !important; }
body:has(#browser > #sidebar-main[width^="35"]) #sidebar-box { width: 341px !important; max-width: 341px !important; } /* fixed typo */
body:has(#browser > #sidebar-main[width^="36"]) #sidebar-box { width: 351px !important; max-width: 351px !important; }
body:has(#browser > #sidebar-main[width^="37"]) #sidebar-box { width: 361px !important; max-width: 361px !important; }
body:has(#browser > #sidebar-main[width^="38"]) #sidebar-box { width: 371px !important; max-width: 371px !important; }
body:has(#browser > #sidebar-main[width^="39"]) #sidebar-box { width: 381px !important; max-width: 381px !important; }

/* 400+ single-digit prefixes (kept last to avoid conflicting with 40–49 two-digit matches) */
body:has(#browser > #sidebar-main[width^="4"]) #sidebar-box  { width: 391px !important; max-width: 391px !important; }
body:has(#browser > #sidebar-main[width^="5"]) #sidebar-box  { width: 491px !important; max-width: 491px !important; }
body:has(#browser > #sidebar-main[width^="6"]) #sidebar-box  { width: 591px !important; max-width: 591px !important; }

#sidebar-box {
	height: 84.5%;
	top: 85px;
  left: 2px;
	position: absolute !important;
	padding: 0px !important;
/*   background-color: var(--toolbar-textcolor) !important; */
}

#sidebar {
  border-radius: 0px !important;
  box-shadow: none !important;
  outline: 0px !important;
  background-color: var(--toolbar-textcolor) !important;
}

#sidebar-panel-header {
  display: none !important;
}
.sidebar-panel-header {
  display: none !important;
}

/* increase ::before height if notifications are live */
/* body:has(#notifications-toolbar) {
  #sidebar-box::before {
    height: 300px;
  }
} */

#notifications-toolbar {
	position: absolute;
	top: 90px;
}


/* ------ s:sidebar-border ---- */ 

/* the gutter between the sidebar and page */
/* on vertical tab mode, hide */
#sidebar-splitter {
  display: none;
}

/* style 1 - hide when all UI */
:root[titlepreface*="᠎"] {
  #sidebar-splitter {
    display: none !important;
  }
}

/* ------ e:sidebar-border ---- */ 


/* ------ s:sideberry ---- */
/* edits are handled in sideberry css file */
/* ------ e:sideberry ---- */


/* ---- e:sidebar ---- */
